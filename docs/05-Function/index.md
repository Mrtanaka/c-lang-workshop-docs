#  関数
C言語勉強会 第五回

kumar  
May 14, 2013  
[引用 : Programming Place Plus](http://www.geocities.jp/ky_webid/index.html)

----
###  関数（サブルーチン）
*何らかの処理を行うために必要な命令文を書き並べたもの*

これまでに、main関数、printf関数、scanf関数といった「*関数*」を使ってきました。 関数は「何らかの処理を行うために必要な命令文を書き並べたもの」といえます。

また、引数を"入力"、関数"出力"と考えると、「とある入力に対してとある出力を返すもの」とも言えます。これは数学の関数 f(x) に似ていますね  
<small>（f(x) = 5xとするとf(10) = 5 * 10 = 50 。この場合入力は10であり出力は50）</small>
![ブラックボックス(Wikimediaより)](./img/Blackbox.png)

「何らかの処理を行うために必要な命令文を書き並べたもの」であり、「とある入力に対してとある出力を返すもの」でもあるのがC言語の関数です。

----
###  関数の３つの構成要素
関数には、「*関数名*」「*引数*」「*戻り値*」という３つの構成要素があります。

* *関数名は、関数に付けられた名前*です。 例えば、main関数なら「main」が名前になります。 関数名として有効な名前は、変数名の規則と同様です（第３章参照）。
* *引数は、関数を呼び出すときに、その関数に指定する値のこと*です。 例えば、printf関数を「printf( "Hello, World" );」のように呼び出しますが、ここで ( ) の中に記述している情報が引数です。 なお、「引数」は「ひきすう」と読みます。
* *戻り値は、関数内の処理が終わったとき、関数側から返される値*です。返し値や返り値と呼ぶ人もいます。実は、main関数の終わりに書いていた return文は、戻り値を返すための命令文です。

----
###  関数の定義（記述）
関数は次のように定義します。

    戻り値の型 関数名( 引数の型と名前, 引数の型と名前, … )  /* 引数は 0個以上 */
    {
        ...
	    
	    return /* 戻り値 */
        /* 戻り値がなければreturn文自体が不要 */
    }

この形式を見ると分かるように、引数や戻り値には型があります。また、引数には１つ１つに名前を付けます。 引数は０個以上の任意の個数記述できます。  
０個の場合には、そのことを意味する「void」と書きます。  
戻り値がない関数の場合は、戻り値の型は「void」です。

----
###  関数の定義（記述）
引数は、関数を呼び出す側と、呼び出される側とで、呼び名を変えることがあります。 *呼び出す側は、引数を実引数*と呼び、*呼び出される側（定義の側）では仮引数*と呼びます。

	void printUnko(int num) {
		int i;
		for(i = 0; i < num; i++) {
			printf("うんこ\n");
		}
	}

	int main(void) {
		printUnko(10);
		return 0;
	}

この例ではnumは仮引数、10は実引数

----
###  main関数
*Ｃ言語では、必ず記述しなければならない必須の関数*

ご存知の通り、Ｃ言語のプログラムは main関数から始まります。

    int main(void) {
        ...
        return 0;
    }

戻り値の型が int型である以上、main関数には必ず return文があります。 main関数の戻り値を 0 にすると、問題無く正常に処理が終了したことを表し、 0以外を返すと、何らかのエラーが発生して終了したことを表すことになっています。

----
###  標準ライブラリ関数
*Ｃ言語の規格によって、あらかじめ用意されている関数*

printf関数や scanf関数のようなものが標準ライブラリ関数に当たります。

標準ライブラリ関数を使うには、「`#include <stdio.h>`」のような記述が必要になります。 「`stdio.h`」の部分は、関数ごとに決まっています。 main関数はこのような記述が不要なので、標準ライブラリ関数とは別です。

[標準Cライブラリ - Wikipedia](http://ja.wikipedia.org/wiki/%E6%A8%99%E6%BA%96C%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA)

----
###  自作関数を定義する

ページ「関数の記述」にならって、底辺の長さと高さを引数に取り、三角形の面積を返す（戻り値）関数を作ってみよう。

    double areaOfTriangle(double b, double h) {
        double ans = b * h / 2.0;
        return ans;
    }
    
----
###  自作関数の呼び出し

当然、標準ライブラリ関数と同じように呼び出して使うことが出来る。

    #include <stdio.h>
    
    double areaOfTriangle(double b, double h) {
        double ans = b * h / 2.0;
        return ans;
    }
    
    /* C言語プログラムは、main関数から実行される */
    int main(void) {
        /* 関数を呼び出し、戻り値を得る */
        double a = areaOfTriangle(5.0, 8.0);
        printf("底辺の長さ5.0、高さ8.0の三角形の面積は %f\n", a);
        
        return 0;
    }
    
----
###  諸々

* 自作関数と標準ライブラリ関数とを完全な別物である、あるいは標準ライブラリ関数がとても特別なもののように考える人がいるようです。 どちらもただの「関数」であることに変わりはありません。 標準ライブラリ関数といえども、どこかに自作関数と同じように中身を記述している部分があります。
* 関数の中から、別の関数を呼び出すことも、もちろん可能です。（というかmain関数も関数ですから当然か）
* 前のページの例のareaOfTriangle関数をmain関数の下に書いた場合、コンパイルで失敗し、実行できない。この場合、areaOfTriangle関数の定義が、main関数でareaOfTriangle関数を呼び出す前に行われていないためです。これは後述の、関数プロトタイプで解決出来ます。

----
###  関数プロトタイプ
*関数名・引数・戻り値の組み合わせを、関数本体と別に記述しておき、 このような関数が存在しているのだということを宣言するもの*

    #include <stdio.h>
    
    double areaOfTriangle(double b, double h);/* 関数プロトタイプ */
    
    int main(void) {
        double a = areaOfTriangle(5.0, 8.0);
        printf("底辺の長さ5.0、高さ8.0の三角形の面積は %f\n", a);
        
        return 0;
    }
    
    double areaOfTriangle(double b, double h) {
        double ans = b * h / 2.0;
        return ans;
    }
    
----
###  関数プロトタイプは必須
*C99以降、そしてC++では、関数プロトタイプは必須*

大規模なプログラムになると、自作のヘッダーファイル（〜.h）に関数プロトタイプだけ書いておいたりします。
例）ヘッダーファイル（triangle.h）

	#ifndef TRIANGLE_H
	#define TRIANGLE_H

	double areaOfTriangle(double b, double h);
	...

	#endif	/* TRIANGLE_H */

例）ヘッダーファイルの読み込み（*.c）

	#include "triangle.h" /* triangle.hがソースと同じディレクトリにある場合 */
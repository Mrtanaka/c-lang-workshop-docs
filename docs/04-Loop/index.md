#  ループ
C言語勉強会 第四回

kumar  
May 13, 2013  
[引用 : Programming Place Plus](http://www.geocities.jp/ky_webid/index.html)

----
###  ループ（反復）ありなしで比較してみる
  * 入力された文字列を10回繰り返し出力する。


----
###  ループを使わなかった場合

*クソ長くてページに収まらない*

    #include <stdio.h>
    
    int main(void) {
        char mozi;
        
        printf("1文字入力してください：");
        scanf("%c", &c);
        
        /* 10回出力する */
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        printf("%c\n", c);
        
        return 0;
    }


----
###  ループを使って書きなおすと

    #include <stdio.h>
    
    int main(void) {
        char mozi;
        
        printf("1文字入力してください：");
        scanf("%c", &mozi);
        
        /* 10回出力する */
        int i = 0;
        while(i < 10) {
            printf("%c\n", mozi);
            i++;    /* iに1を足す。（インクリメントという） */
        }
        
        return 0;
    }

*スッキリ！！*<small>その気になれば10000回ループも簡単</small>

----
###  while文
*条件式が真である限り繰り返す文*

while文の構造）

    while( 条件式 ){
        ループさせる処理
    }

*「条件式」の部分には、「処理を繰り返すのはどんなときか」を記述します。*

----
###  while文
実行される処理の順序

1. 「条件式」を調べる。「真」なら２へ。「偽」なら４へ。
2. 「ループさせる処理」を実行する。３へ。
3. 「ループさせる処理」が全て終了したら１へ戻る。
4.  while文を終了させて、次の処理へ進む。

----
###  while文

ページ「ループを使ってみると」の例より抜粋）

    /* 10回出力する */
    int i = 0;
    while(i < 10) {
        printf("%c\n", mozi);
        i++;    /* iに1を足す。（インクリメントという） */
    }
    
どのように動作してこのコードで処理が10回繰り返されるのか、イメージしてみましょう。

----
###  より高機能なループ文がある

    #include <stdio.h>
    
    int main(void) {
        char mozi;
        
        printf("1文字入力してください：");
        scanf("%c", &mozi);
        
        /* 10回出力する */
        int i;
        for(i = 0; i < 10; i++) {
            printf("%c\n", mozi);
        }
        
        return 0;
    }
    
*状況によりwhile文よりもさらに短く書ける！！*

----
###  for文
*while文よりも高機能なループ文*

for文の構造）

    for( 初期設定式; 条件式; 再設定式 ){
        ループさせる処理
    }


* *「初期設定式」は、最初に for文に差し掛かったときに、１度だけ実行される式*です。 ここで、ループを始める前の準備を行います。
* *「条件式」は、while文のものと同じ*で、真のときループし、偽のときに for文全体を終了させ、抜けます。
* *「再設定式」は*、「ループさせる処理」が最後まで終了したときに実行される式で、*１回分のループを終える度に実行されます*。

----
###  for文
実行される処理の順序

1. 「初期設定式」を実行。２へ。
2. 「条件式」を調べる。「真」なら３へ。「偽」なら６へ。
3. 「ループさせる処理」を実行する。４へ。
4. 「ループさせる処理」が全て終了したら５へ。
5. 「再設定式」を実行。２へ戻る。
6. for文を終了させて、次の処理へ進む。

----
###  for文

ページ「より高機能なループ文がある」の例より抜粋）

    /* 10回出力する */
    int i;
    for(i = 0; i < 10; i++) {
        printf("%c\n", mozi);
    }
    
再び、どのように動作してこのコードで処理が10回繰り返されるのか、イメージしてみましょう。

----
###  do文（do-while文）
*do文では、ループ内の処理が必ず１度は実行される。*

do文の構造）

    do{
        ループさせる処理
    } while( 条件式 );
    
while文やfor文では、条件式が負の場合、ループ内の処理が１度も実行されないことがあるのですが、do文では、ループ内の処理が必ず１度は実行されます。

ご察しの通り、ループさせる処理を実行してから、条件式を評価してループを継続するか判断します。

他のループ文に比べて、使う機会が非常に少ないループ文です。

----
###  goto文
*同じ関数内の別の場所へ一気に移動させる。 移動先はラベルで表現する。*

*※この文は使ってはならない。とよく言われます。*goto文は（同じ関数内であれば）どこへでも移動できるため、処理の流れが非常に分かりにくくなる可能性が高いからです。<small>どうしても使いたい場合はいいですがやめておきましょう。</small>
    
        goto ラベル名;

ラベル

    ラベル名:
----
###  goto文の例

    #include <stdio.h>
    
    int main(void) {
        int i = 0;
    unko:    /* これがラベル */
        if(i >= 5) {
            goto final_unko;    /* iが5以上ならラベルfinal_unkoへジャンプ */
        }
        printf("変数iは今 %d\n", i);
    
        i++;
        goto unko;  /* ラベルunkoへジャンプ */
    
    final_unko:

        return 0;
    }

----
###  無限ループ
*永遠に繰り返されるループ*

無限ループの例）

    while( 1 ){ /* C言語では0以外はtrueに相当 */
        printf("unko\n");
    }
    
このプログラムを実行すると、永遠にunkoと出力され続ける。（ちなみに、Ctrl + Cで、端末で実行中のプログラムを強制終了できる。）


----
###  break;
*ループ文を、中断して抜ける。*

前のページの「無限ループの例」を、while文の条件式を true から変えずに、break文を使って、5回だけ出力するように書き換えてみる。

    int i = 0;
    while( 1 ){
        if(i >= 5) {
            break;
        }
        printf("unko\n");
        i++;
    }
    
if文を使い、i が 5 (以上)になったとき、break を発動させ、ループを中断して抜けだした。

<small>ちなみに、switch文も抜け出すことができる。</small>

----
###  continue;
*現在のループを打ち切り（後続の処理を無視して）次のループへ進ませる*

for文の場合は「再設定式」が実行されてから、次へ進みます。 次のループへ進んだとき、当然「条件式」がチェックされます。これが偽になれば、ループ全体を終えることになります。

    int i;
    for(i = 0; i < 5; i++) {
        scanf(" %c", &mozi);
        if(c == 'a') {
            count++;
            continue;
        }
        /* continueされた場合continueより下に書かれているので実行されない */
        printf("aを入力しろよ！！！次から気をつけろよ！！！\n");
    }


----
###  諸々 1
for文の構造）

    for( 初期設定式; 条件式; 再設定式 ){
        ループさせる処理
    }
    
これは、通常のwhile文に文を多少加えた

    初期設定式;
    while( 条件式 ){
        ループさせる処理
        再設定式;
    }
    
と同じ動きをしています。今までの内容から気づいていた人も多いかと思います。

----
###  諸々 2
また、for文の式はすべて省略が可能です。例えば、

    for( ; ; ){
        ループさせる処理
    }
    
このように省略する事もできます。この場合無限ループになります。

----
###  諸々 3
for文の初期設定式において、変数を宣言することが可能。

ページ「for文」の例を改変）

        for(int i = 0; i < 10; i++) {
            printf("%c\n", mozi);
        }
        
int iをfor文の外で宣言せずに、初期設定式の中で宣言している。行数が減って楽である。（*ただし、C99以前では不可能。*）

----
###  諸々 4
ループ文もif文と同様に、処理が１行であるなら大括弧{}を省略できる。

    for( 初期設定式; 条件式; 再設定式 )
        ループさせる処理
        
ループ文の中にループ文を入れ子（ネスト）して書くことが出来る。

    while( 条件式 ){
        ...
        while( 条件式 ){
            ...
        }
        ...
    }